<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#0A0F1E">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="DeliverPro">
<title>DeliverPro</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
<script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css">
<!-- Google APIs -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://apis.google.com/js/api.js" async defer></script>
<style>
:root{
  --bg:#0A0F1E;--surface:#111827;--surface2:#1C2537;--surface3:#243049;
  --accent:#3B82F6;--accent2:#6366F1;--green:#10B981;--orange:#F59E0B;
  --red:#EF4444;--purple:#8B5CF6;--yellow:#FBBF24;--teal:#14B8A6;
  --text:#F1F5F9;--text2:#94A3B8;--text3:#475569;
  --border:rgba(255,255,255,0.07);--card-shadow:0 4px 24px rgba(0,0,0,0.4);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;padding-bottom:85px}

.header{background:linear-gradient(135deg,#0F172A,#1E2D4D);padding:14px 16px 12px;position:sticky;top:0;z-index:100;border-bottom:1px solid var(--border)}
.header-top{display:flex;justify-content:space-between;align-items:center;gap:8px}
.logo{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;background:linear-gradient(135deg,#3B82F6,#8B5CF6);-webkit-background-clip:text;-webkit-text-fill-color:transparent;white-space:nowrap}
.header-right{display:flex;align-items:center;gap:6px;flex-shrink:0}
.header-stats{display:flex;gap:10px;margin-top:10px;overflow-x:auto}
.hstat{text-align:center;flex-shrink:0}
.hstat-val{font-family:'Syne',sans-serif;font-size:17px;font-weight:700;color:var(--accent)}
.hstat-label{font-size:9px;color:var(--text2);text-transform:uppercase;letter-spacing:1px}

/* GOOGLE LOGIN */
.google-login-bar{
  background:linear-gradient(135deg,rgba(59,130,246,0.1),rgba(99,102,241,0.08));
  border:1px solid rgba(59,130,246,0.2);
  border-radius:12px;padding:10px 14px;margin:12px 16px 0;
  display:flex;align-items:center;gap:10px;cursor:pointer;
}
.google-login-bar.logged-in{background:linear-gradient(135deg,rgba(16,185,129,0.1),rgba(5,150,105,0.08));border-color:rgba(16,185,129,0.2);}
.g-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#3B82F6,#8B5CF6);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;flex-shrink:0;overflow:hidden}
.g-avatar img{width:100%;height:100%;object-fit:cover}
.g-info{flex:1;min-width:0}
.g-name{font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.g-sub{font-size:11px;color:var(--text2)}
.g-action{font-size:12px;font-weight:600;color:var(--accent);white-space:nowrap}
.g-action.syncing{color:var(--orange)}
.g-action.synced{color:var(--green)}

.bottom-nav{position:fixed;bottom:0;left:0;right:0;background:rgba(17,24,39,0.97);backdrop-filter:blur(20px);border-top:1px solid var(--border);display:flex;z-index:200;padding-bottom:env(safe-area-inset-bottom)}
.nav-btn{flex:1;display:flex;flex-direction:column;align-items:center;padding:10px 4px 8px;background:none;border:none;color:var(--text3);font-family:'DM Sans',sans-serif;font-size:10px;cursor:pointer;transition:all 0.2s;gap:4px}
.nav-btn.active{color:var(--accent)}
.nav-btn svg{width:22px;height:22px}

.screen{display:none;padding:16px;animation:fadeIn 0.3s ease}
.screen.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}

.card{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:16px;margin-bottom:12px;box-shadow:var(--card-shadow)}
.section-title{font-family:'Syne',sans-serif;font-size:13px;font-weight:700;text-transform:uppercase;letter-spacing:2px;color:var(--text2);margin-bottom:12px;display:flex;align-items:center;gap:8px}
.section-title::after{content:'';flex:1;height:1px;background:var(--border)}

/* PHOTO SECTION */
.photo-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}
.photo-thumb{
  aspect-ratio:1;border-radius:10px;overflow:hidden;
  background:var(--surface2);border:1px solid var(--border);
  position:relative;cursor:pointer;
}
.photo-thumb img{width:100%;height:100%;object-fit:cover}
.photo-thumb .photo-del{
  position:absolute;top:4px;right:4px;
  background:rgba(239,68,68,0.85);color:#fff;
  border:none;border-radius:6px;padding:3px 6px;font-size:11px;cursor:pointer;
}
.photo-thumb .photo-drive{
  position:absolute;bottom:4px;left:4px;
  background:rgba(16,185,129,0.85);color:#fff;
  border-radius:5px;padding:2px 5px;font-size:9px;font-weight:700;
}
.add-photo-btn{
  aspect-ratio:1;border-radius:10px;
  background:var(--surface2);border:2px dashed rgba(59,130,246,0.3);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  cursor:pointer;gap:4px;color:var(--accent);font-size:11px;font-weight:600;
}
.add-photo-btn svg{width:24px;height:24px}

/* PHOTO VIEWER */
.photo-viewer{
  position:fixed;inset:0;background:rgba(0,0,0,0.95);
  z-index:800;display:none;align-items:center;justify-content:center;flex-direction:column;
}
.photo-viewer.show{display:flex}
.photo-viewer img{max-width:95vw;max-height:80vh;border-radius:12px;object-fit:contain}
.photo-viewer-close{position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.1);border:none;color:#fff;border-radius:10px;padding:10px 14px;cursor:pointer;font-size:16px}
.photo-viewer-name{color:var(--text2);font-size:13px;margin-top:12px;text-align:center;padding:0 20px}

/* TIME NOTE */
.time-note-badge{display:inline-flex;align-items:center;gap:5px;background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(245,158,11,0.15));border:1px solid rgba(251,191,36,0.4);color:var(--yellow);padding:4px 10px;border-radius:8px;font-size:12px;font-weight:700;margin-top:4px}
.time-note-badge.urgent{background:linear-gradient(135deg,rgba(239,68,68,0.2),rgba(220,38,38,0.15));border-color:rgba(239,68,68,0.4);color:var(--red);animation:urgentPulse 1.5s infinite}
@keyframes urgentPulse{0%,100%{opacity:1}50%{opacity:0.6}}

/* FLOATING PARCEL */
.floating-parcel{position:fixed;bottom:88px;left:12px;right:12px;background:linear-gradient(135deg,#1a2540,#1e2d4a);border:2px solid var(--orange);border-radius:20px;padding:14px 16px;z-index:190;box-shadow:0 8px 40px rgba(245,158,11,0.35);display:none;animation:floatUp 0.35s cubic-bezier(0.34,1.56,0.64,1)}
@keyframes floatUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}
.floating-parcel.visible{display:block}
.fp-top{display:flex;align-items:flex-start;gap:10px;margin-bottom:8px}
.fp-photo{width:48px;height:48px;border-radius:10px;background:var(--surface3);overflow:hidden;flex-shrink:0;border:1px solid var(--border)}
.fp-photo img{width:100%;height:100%;object-fit:cover}
.fp-photo-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:22px}
.fp-info{flex:1;min-width:0}
.fp-name{font-weight:700;font-size:15px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.fp-phone{font-size:12px;color:var(--text2);margin-top:1px}
.fp-addr{font-size:11px;color:var(--text3);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:2px}
.fp-time-note{background:linear-gradient(135deg,rgba(251,191,36,0.15),rgba(245,158,11,0.1));border:1px solid rgba(251,191,36,0.35);border-radius:10px;padding:7px 12px;margin-bottom:8px;display:flex;align-items:center;gap:8px}
.fp-time-note.urgent{background:linear-gradient(135deg,rgba(239,68,68,0.15),rgba(220,38,38,0.1));border-color:rgba(239,68,68,0.35);animation:urgentPulse 1.5s infinite}
.fp-close{position:absolute;top:12px;right:12px;width:28px;height:28px;background:var(--surface3);border:none;border-radius:7px;color:var(--text2);cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center}
.fp-actions{display:flex;gap:8px}
.fp-nav-btn{flex:2;display:flex;align-items:center;justify-content:center;gap:6px;padding:11px;background:linear-gradient(135deg,#3B82F6,#6366F1);border:none;border-radius:11px;color:#fff;font-family:'DM Sans',sans-serif;font-size:14px;font-weight:700;cursor:pointer;transition:all 0.15s}
.fp-nav-btn:active{transform:scale(0.96)}
.fp-call-btn{flex:1;display:flex;align-items:center;justify-content:center;gap:5px;padding:11px;background:rgba(16,185,129,0.15);border:1px solid rgba(16,185,129,0.3);border-radius:11px;color:var(--green);font-family:'DM Sans',sans-serif;font-size:14px;font-weight:700;cursor:pointer}

/* PROXIMITY */
.proximity-alert{position:fixed;top:80px;left:12px;right:12px;z-index:300;border-radius:16px;padding:14px 16px;display:none;animation:dropDown 0.4s cubic-bezier(0.34,1.56,0.64,1)}
@keyframes dropDown{from{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}
.proximity-alert.show{display:flex;align-items:center;gap:12px}
.proximity-alert.near{background:linear-gradient(135deg,#064E3B,#065F46);border:2px solid var(--green);box-shadow:0 8px 32px rgba(16,185,129,0.3)}
.proximity-alert.very-near{background:linear-gradient(135deg,#7C2D12,#9A3412);border:2px solid var(--orange);box-shadow:0 8px 32px rgba(245,158,11,0.4)}
.prox-close{background:rgba(255,255,255,0.1);border:none;color:#fff;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:12px}

/* FORM */
.form-group{margin-bottom:14px}
.form-label{font-size:11px;color:var(--text2);text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;display:block;font-weight:600}
.form-input{width:100%;padding:12px 14px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:15px;outline:none;transition:border-color 0.2s}
.form-input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(59,130,246,0.1)}
.form-input::placeholder{color:var(--text3)}
textarea.form-input{resize:none;height:65px}

.time-section{background:linear-gradient(135deg,rgba(251,191,36,0.08),rgba(245,158,11,0.05));border:1px solid rgba(251,191,36,0.2);border-radius:12px;padding:14px;margin-bottom:14px}
.time-presets{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}
.time-preset{padding:7px 12px;border-radius:8px;border:1px solid rgba(251,191,36,0.25);background:rgba(251,191,36,0.08);color:var(--yellow);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer}
.time-preset.selected{background:rgba(251,191,36,0.25);border-color:rgba(251,191,36,0.6)}

.btn{display:flex;align-items:center;justify-content:center;gap:8px;padding:13px 20px;border-radius:12px;border:none;font-family:'DM Sans',sans-serif;font-size:15px;font-weight:600;cursor:pointer;transition:all 0.2s;width:100%}
.btn-primary{background:linear-gradient(135deg,#3B82F6,#6366F1);color:#fff}
.btn-primary:active{transform:scale(0.97)}
.btn-green{background:linear-gradient(135deg,#10B981,#059669);color:#fff}
.btn-red{background:linear-gradient(135deg,#EF4444,#DC2626);color:#fff}
.btn-ghost{background:var(--surface2);color:var(--text);border:1px solid var(--border)}
.btn-sm{padding:8px 14px;font-size:13px;border-radius:8px;width:auto}
.btn-google{background:linear-gradient(135deg,#fff,#f8f8f8);color:#333;border:1px solid #ddd}

/* PARCEL CARD */
.parcel-card{background:var(--surface);border:1px solid var(--border);border-radius:16px;overflow:hidden;margin-bottom:10px;transition:all 0.2s;cursor:pointer}
.parcel-card.delivered{opacity:0.4}
.parcel-card.selected-card{border-color:var(--orange);box-shadow:0 0 24px rgba(245,158,11,0.2)}
.parcel-card.has-time{border-left:3px solid var(--yellow)}
.parcel-card.urgent-time{border-left:3px solid var(--red)}
.parcel-card.has-photo{border-top:2px solid rgba(59,130,246,0.3)}

.parcel-header{display:flex;align-items:flex-start;gap:10px;padding:12px 14px 8px}
.parcel-thumb{width:44px;height:44px;border-radius:10px;overflow:hidden;background:var(--surface2);flex-shrink:0;border:1px solid var(--border);position:relative}
.parcel-thumb img{width:100%;height:100%;object-fit:cover}
.parcel-thumb-placeholder{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:20px}
.parcel-num-badge{position:absolute;top:-2px;left:-2px;width:18px;height:18px;border-radius:5px;background:var(--accent);display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:#fff}
.parcel-num-badge.locked{background:var(--purple)}
.parcel-num-badge.done{background:var(--green)}

.parcel-info{flex:1;min-width:0}
.parcel-name{font-weight:700;font-size:15px}
.parcel-sub{font-size:12px;color:var(--text2);margin-top:2px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

.card-time-note{margin:0 14px 8px;background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(245,158,11,0.08));border:1px solid rgba(251,191,36,0.3);border-radius:9px;padding:7px 11px;display:flex;align-items:center;gap:7px}
.card-time-note.urgent{background:linear-gradient(135deg,rgba(239,68,68,0.12),rgba(220,38,38,0.08));border-color:rgba(239,68,68,0.3)}
.card-time-note span{font-size:12px;font-weight:700;color:var(--yellow)}
.card-time-note.urgent span{color:var(--red)}

.parcel-actions{display:flex;gap:7px;padding:0 14px 12px;flex-wrap:wrap}
.action-chip{display:flex;align-items:center;gap:4px;padding:7px 11px;border-radius:8px;border:none;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:all 0.15s}
.action-chip:active{transform:scale(0.95)}
.chip-nav{background:rgba(59,130,246,0.15);color:var(--accent)}
.chip-call{background:rgba(16,185,129,0.15);color:var(--green)}
.chip-edit{background:rgba(245,158,11,0.15);color:var(--orange)}
.chip-del{background:rgba(239,68,68,0.15);color:var(--red)}
.chip-done{background:rgba(16,185,129,0.15);color:var(--green)}
.chip-photo{background:rgba(139,92,246,0.15);color:var(--purple)}

#map{height:260px;border-radius:12px;overflow:hidden;border:1px solid var(--border)}
#location-picker-map{height:100%;border-radius:0;border:none}

.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);backdrop-filter:blur(8px);z-index:500;align-items:flex-end}
.modal-overlay.active{display:flex}
.modal{background:var(--surface);border-radius:24px 24px 0 0;padding:20px;width:100%;max-height:93vh;overflow-y:auto;animation:slideUp 0.3s cubic-bezier(0.34,1.56,0.64,1)}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-handle{width:40px;height:4px;background:var(--surface3);border-radius:2px;margin:0 auto 16px}
.modal-title{font-family:'Syne',sans-serif;font-size:20px;font-weight:700;margin-bottom:18px}

.location-modal{position:fixed;inset:0;background:var(--bg);z-index:600;display:none;flex-direction:column}
.location-modal.active{display:flex}
.location-modal-header{padding:14px 16px;background:var(--surface);border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;flex-shrink:0}
.location-modal-map{flex:1;position:relative}
.location-modal-bottom{background:var(--surface);padding:14px 16px;border-top:1px solid var(--border);flex-shrink:0}

.gps-box{display:none;border-radius:10px;padding:10px 14px;margin-bottom:10px;align-items:center;gap:10px}
.gps-box.show{display:flex}
.gps-ok{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3)}
.gps-warn{background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.3)}
.gps-bad{background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3)}
.gps-dot{width:10px;height:10px;border-radius:50%;flex-shrink:0;animation:gpsPulse 1.5s infinite}
.gps-ok .gps-dot{background:var(--green)}
.gps-warn .gps-dot{background:var(--orange)}
.gps-bad .gps-dot{background:var(--red);animation:none}
@keyframes gpsPulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.5;transform:scale(1.4)}}

.route-progress-bar{height:6px;background:var(--surface3);border-radius:3px;overflow:hidden;margin:8px 0}
.route-progress-fill{height:100%;background:linear-gradient(90deg,var(--green),#34D399);border-radius:3px;transition:width 0.5s ease}

.search-bar{display:flex;align-items:center;gap:10px;background:var(--surface2);border:1px solid var(--border);border-radius:12px;padding:10px 14px;margin-bottom:12px}
.search-bar input{background:none;border:none;color:var(--text);font-family:'DM Sans',sans-serif;font-size:15px;outline:none;flex:1}
.search-bar input::placeholder{color:var(--text3)}

.toggle{width:48px;height:26px;background:var(--surface3);border-radius:13px;position:relative;cursor:pointer;transition:background 0.2s;flex-shrink:0;border:none}
.toggle.on{background:var(--accent)}
.toggle::after{content:'';position:absolute;width:20px;height:20px;border-radius:50%;background:#fff;top:3px;left:3px;transition:transform 0.2s}
.toggle.on::after{transform:translateX(22px)}

.scanner-container{position:relative;background:#000;border-radius:16px;overflow:hidden;aspect-ratio:1;max-width:320px;margin:0 auto}
#scanner-video,#form-scanner-video{width:100%;height:100%;object-fit:cover}
.scanner-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center}
.scanner-frame{width:65%;aspect-ratio:1;border:3px solid var(--accent);border-radius:16px;box-shadow:0 0 0 9999px rgba(0,0,0,0.5);position:relative}
.scanner-line{position:absolute;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--accent),transparent);animation:scanLine 2s linear infinite}
@keyframes scanLine{0%{top:0}100%{top:100%}}

/* SYNC STATUS */
.sync-badge{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:6px;font-size:11px;font-weight:600}
.sync-ok{background:rgba(16,185,129,0.15);color:var(--green)}
.sync-pending{background:rgba(245,158,11,0.15);color:var(--orange)}
.sync-off{background:rgba(100,116,139,0.15);color:var(--text3)}

.toast{position:fixed;bottom:92px;left:50%;transform:translateX(-50%);background:var(--surface);color:var(--text);padding:12px 20px;border-radius:12px;font-size:14px;font-weight:500;box-shadow:0 8px 32px rgba(0,0,0,0.5);border:1px solid var(--border);z-index:1000;opacity:0;transition:opacity 0.3s;white-space:nowrap;max-width:90vw}
.toast.show{opacity:1}
.toast.success{border-color:rgba(16,185,129,0.4)}
.toast.error{border-color:rgba(239,68,68,0.4)}

.io-btn{display:flex;align-items:center;gap:12px;padding:14px 16px;border-radius:12px;background:var(--surface2);border:1px solid var(--border);color:var(--text);font-family:'DM Sans',sans-serif;font-size:14px;font-weight:500;cursor:pointer;margin-bottom:10px;width:100%;text-align:left}
.io-icon{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.empty-state{text-align:center;padding:48px 20px;color:var(--text3)}
.leaflet-container{background:#1a2035 !important}
.leaflet-tile{filter:brightness(0.85) saturate(0.8) hue-rotate(180deg) invert(0.9)}

/* DRIVE STATUS */
.drive-bar{background:linear-gradient(135deg,rgba(16,185,129,0.08),rgba(5,150,105,0.05));border:1px solid rgba(16,185,129,0.15);border-radius:12px;padding:12px 14px;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between;gap:10px}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-top">
    <div class="logo">âš¡ DeliverPro</div>
    <div class="header-right">
      <button class="btn btn-ghost btn-sm" onclick="openScanner()" style="padding:8px 10px">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-
